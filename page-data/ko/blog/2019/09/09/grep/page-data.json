{"componentChunkName":"component---src-templates-post-tsx","path":"/ko/blog/2019/09/09/grep/","result":{"data":{"site":{"siteMetadata":{"title":"클래스101 기술 블로그","author":"class101","siteUrl":"https://class101.dev"}},"markdownRemark":{"id":"1ab357f9-a620-59a2-acd9-96e3b8adf9e1","tableOfContents":"<ul>\n<li><a href=\"/blog/2019/09/09/grep/#overview\">Overview</a></li>\n<li><a href=\"/blog/2019/09/09/grep/#%ED%81%B4%EB%9E%98%EC%8A%A4101%EC%9D%B4-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EB%8F%84%EC%9E%85%ED%95%98%EA%B2%8C-%EB%90%9C-%EA%B3%84%EA%B8%B0\">클래스101이 테스트를 도입하게 된 계기</a></li>\n<li><a href=\"/blog/2019/09/09/grep/#%ED%81%B4%EB%9E%98%EC%8A%A4101-%EC%84%9C%EB%B2%84-%ED%99%98%EA%B2%BD\">클래스101 서버 환경</a></li>\n<li><a href=\"/blog/2019/09/09/grep/#%ED%81%B4%EB%9E%98%EC%8A%A4101-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%99%98%EA%B2%BD\">클래스101 테스트 환경</a></li>\n<li><a href=\"/blog/2019/09/09/grep/#jest-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">Jest 환경 설정하기</a></li>\n<li>\n<p><a href=\"/blog/2019/09/09/grep/#unit--integration-test-%EC%98%88%EC%8B%9C\">Unit , Integration Test 예시</a></p>\n<ul>\n<li><a href=\"/blog/2019/09/09/grep/#unit-test\">Unit Test</a></li>\n<li><a href=\"/blog/2019/09/09/grep/#integration-test\">Integration Test</a></li>\n</ul>\n</li>\n<li><a href=\"/blog/2019/09/09/grep/#%EB%A7%88%EB%AC%B4%EB%A6%AC\">마무리</a></li>\n<li><a href=\"/blog/2019/09/09/grep/#%EC%B0%B8%EA%B3%A0%EB%AC%B8%ED%97%8C\">참고문헌</a></li>\n</ul>","excerpt":"Overview 개발자들은 느낄 겁니다. 몇 달만 지나도 새로운 프레임워크나 언어가 나오고, 개발 방향을 잡아주는 개발 방법론에도 트렌드가 있다는 것을 말이죠. 요즘은 TDD(Test Driven Development)가 큰 인기를 휩쓸고 있습니다.  TDD는 간단하게 이야기해서 테스트가 개발을 이끈다고 해서, 테스트 코드를 먼저 짜고 그 다음 메인 코드를 짜는 방식으로 개발을 진행합니다. 테스트를 먼저 짜게 되면서 자연스럽게 예외 상황과 동작 방식을 생각하게 되어 메인 코드를 작성할 때 더 좋은 코드가 나올 수 있습니다. 또한 …","html":"<h2>Overview</h2>\n<p>개발자들은 느낄 겁니다. 몇 달만 지나도 새로운 프레임워크나 언어가 나오고, 개발 방향을 잡아주는 개발 방법론에도 트렌드가 있다는 것을 말이죠. 요즘은 TDD(Test Driven Development)가 큰 인기를 휩쓸고 있습니다. </p>\n<p>TDD는 간단하게 이야기해서 테스트가 개발을 이끈다고 해서, 테스트 코드를 먼저 짜고 그 다음 메인 코드를 짜는 방식으로 개발을 진행합니다. 테스트를 먼저 짜게 되면서 자연스럽게 예외 상황과 동작 방식을 생각하게 되어 메인 코드를 작성할 때 더 좋은 코드가 나올 수 있습니다. 또한 팀 내 개발자가 코드를 잘못 건드리더라도 테스트를 통과하지 못하기에 빠르게 문제 원인을 찾고 해결할 수 있습니다. 이는 사이드 이펙트를 줄이는데도 큰 도움이 될 것입니다. (전제 조건은 좋은 테스트 코드를 짜는 것입니다.)</p>\n<h2>클래스101이 테스트를 도입하게 된 계기</h2>\n<p>우리는 기술의 ‘안정성’과 ‘기능 개발’ 두 가지를 모두 잡기 위해 고군분투하고 있습니다. 하루에 한 번씩 서버와 웹을 전부 배포하고 있으며, 매일 새로운 기능들과 유지보수 작업이 이뤄지고 있습니다. 그러나 프로덕트 개발팀의 인원이 많아지면서 기능 개발을 하는 만큼 유지보수의 시간도 늘어나게 되었습니다. 결국 생산성 저하를 감지한 개발팀에서는 테스트 환경을 제대로 구축하고 커버리지를 높이기 위한 계획을 세우기로 했습니다.</p>\n<h2>클래스101 서버 환경</h2>\n<p>가장 먼저 사용 언어를 TypeScript로 통일했습니다. 주요 모듈(GraphQL, Mongoose)들에서 타입을 손쉽게 체크할 수 있도록 TypeGraphQL, TypeGoose를 사용하고 있습니다. TypeGraphQL은 Query, Mutation을 Class 형태로 작성하도록 있게 해주며 DI(의존성 주입)도 가능하게 합니다.</p>\n<p>클래스101 GraphQL 서버에서는 비즈니스 로직을 <strong>Resolver Layer</strong>에서 담당합니다. 하위 레이어인 <strong>Service Layer</strong>는 Resolver에 필요한 실제 로직을 담으면서 클래스로 명확하게 분리되어 있습니다. 더불어 TypeDI라는 Typescript용 DI 모듈을 이용해서 OOP 아키텍처에서 쉽게 의존성을 주입받을 수 있습니다.</p>\n<h2>클래스101 테스트 환경</h2>\n<p>Javascript에서 테스트를 짤 때 가장 유명한 테스트 프레임워크로는 Jest와 Mocha가 있습니다. 이 중에 개발팀에서 고른 프레임워크는 Jest입니다. Jest는 Snapshot, Mocking, Assertion Library등이 전부 내장되어 있으며 Test를 병렬적으로 돌릴 수 있다는 장점이 있습니다. Typescript 환경이므로 Jest를 돌리기 위한 두 가지 대표적인 방법이 있습니다.</p>\n<ol>\n<li>Typescript를 Javascript로 트랜스파일링한 후 돌리기</li>\n<li>Ts-node로 별도의 트랜스파일링 작업 없이 실행한 후 ts-jest를 사용하기</li>\n</ol>\n<p>테스트 환경을 빠르게 구축하기 위해 두 번째 방법을 택했습니다.</p>\n<p><strong>mongodb-memory-server</strong>는 MongoDB를 메모리에서 빠르게 실행할 수 있게 해주는 모듈입니다. 또한 Test Suite마다 독립적인 데이터베이스 환경을 제공해서 Test Suite끼리의 의존성을 없앨 수 있습니다. <strong>faker</strong>라는 fake data를 생성해주는 모듈도 사용했습니다. 이에 Mock Data를 손쉽게 생성할 수 있습니다.</p>\n<h2>Jest 환경 설정하기</h2>\n<ol>\n<li>\n<p>Module 설치하기</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> init -y\n<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -g typescript\n<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> jest ts-jest @types/jest mongodb-memory-server faker --dev </code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">package.json</code> 설정하기</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@class101/apollo-server\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.0.1\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"private\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    ...\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">//스크립트에서 바로 jest를 실행할 수 있지만 Programmatic한 환경 설정을 위해 실행 파일을 따로 분리했습니다.</span>\n\t\t<span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node --project ./tsconfig.json -r tsconfig-paths/register tests/index.ts\"</span><span class=\"token punctuation\">,</span>\n\t\t...\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@types/jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^24.0.17\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"faker\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^4.1.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^24.8.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ts-jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^24.0.2\"</span>\n\t\t...\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">tsconfig.json</code> : Typescript 기본 설정 파일입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strictPropertyInitialization\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedParameters\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"forceConsistentCasingInFileNames\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noFallthroughCasesInSwitch\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noImplicitReturns\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\n\t\t...\n    <span class=\"token property\">\"paths\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">//Module Alias 설정으로 import를 할 때 절대경로처럼 사용합니다.</span>\n      ...\n      <span class=\"token property\">\"@tests/*\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"tests/*\"</span><span class=\"token punctuation\">]</span>  \n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./build\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"**/*.ts\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">jest.config.js</code> : Jest 기본 설정 파일입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  compilerOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> paths <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./tsconfig'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> resolve <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> moduleNameMapper <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//jest환경에서도 module Alias를 사용하기 위해 tsConfig의 paths를 가공해서 설정해줍니다.</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> paths<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n  <span class=\"token keyword\">const</span> moduleName <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">(.*)$</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  moduleNameMapper<span class=\"token punctuation\">[</span>moduleName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./src/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>paths<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> paths<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">$1</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  testEnvironment<span class=\"token operator\">:</span> <span class=\"token string\">'node'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//jest를 node 환경에서 돌리기 위해선 testEnvironment 설정이 필요합니다.</span>\n  roots<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'&lt;rootDir>/src'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  transform<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'^.+\\\\.tsx?$'</span><span class=\"token operator\">:</span> <span class=\"token string\">'ts-jest'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  testRegex<span class=\"token operator\">:</span> <span class=\"token string\">'(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.tsx?$'</span><span class=\"token punctuation\">,</span>\n  moduleFileExtensions<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'ts'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tsx'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'jsx'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'node'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  moduleNameMapper<span class=\"token punctuation\">,</span>\n  setupFilesAfterEnv<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'&lt;rootDir>/src/tests/setup.ts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//테스트가 돌아가기 전에 의존성이나 추가 환경을 구성하기위한 setup file입니다.  </span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">&lt;Root&gt;/tests/index.ts</code> : Jest 를 Programmatic하게 실행하는 파일입니다. Package.json의 스크립트로 바로 돌리지 않고 이렇게 하는 이유는 Programmatic 설정을 할 수 있기 때문입니다. </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> jest <span class=\"token keyword\">from</span> <span class=\"token string\">'jest'</span><span class=\"token punctuation\">;</span>\nprocess<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> argv <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//추가적인 Test 환경 설정을 할 수 있습니다.</span>\n\njest<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">/tests/setup.ts</code> : 테스트를 하기 전에 데이터베이스 의존성 설정을 해줍니다. 이때 monogodb-memory-server를 실행하고 Mongoose(mongodb ODM Library)와 연결시킵니다. 추가적으로 테스트에서 전역으로 사용할 수 있도록 Default Mock Data 세팅을 해줍니다. 이때 mongodb-memory-server가 Test Suit마다 독립성을 보장해주므로 테스트 환경에서의 데이터의 일관성을 보장해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MongoMemoryServer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mongodb-memory-server'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> mongoose <span class=\"token keyword\">from</span> <span class=\"token string\">'mongoose'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">MOCKING_PATH</span> <span class=\"token operator\">=</span> <span class=\"token string\">'@tests/__mocks__'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> mongoMemoryServer<span class=\"token operator\">:</span> MongoMemoryServer<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token parameter\">done</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">clearDB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>mongoose<span class=\"token punctuation\">.</span>connection<span class=\"token punctuation\">.</span>collections<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">collection</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* tslint:disable:no-empty */</span>\n      collection<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mongoose<span class=\"token punctuation\">.</span>connection<span class=\"token punctuation\">.</span>readyState <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    mongoMemoryServer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MongoMemoryServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mongoMemoryServer\n      <span class=\"token punctuation\">.</span><span class=\"token function\">getConnectionString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mongoUri</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_URI</span> <span class=\"token operator\">=</span> mongoUri<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> mongoose<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>mongoUri<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          useNewUrlParser<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n          poolSize<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">RUNNING_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'development'</span> <span class=\"token operator\">?</span> <span class=\"token number\">10</span> <span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> <span class=\"token function\">createMocksInMongoDB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">clearDB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token parameter\">done</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> mongoose<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> mongoMemoryServer<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//자주쓰이는 기본 Mock Data들을 미리 생성해놓습니다.</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">createMocksInMongoDB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n  <span class=\"token keyword\">await</span> <span class=\"token function\">createUserMocks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ol>\n<h2>Unit , Integration Test 예시</h2>\n<h3>Unit Test</h3>\n<p>TypeDI에서 테스트할 Service 클래스를 주입받아 사용했습니다. beforeAll에서 추가 의존성을 넣어주고 afterAll에서 다시 초기화합니다. 아래는 클래스101의 수강권 관련 테스트 로직 예시입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> KlassTicketService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@graphqlSchema/klassDomain/klassTicket/klassTicket.service'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> KlassTicketModel <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@mongooseModels/KlassTicket/KlassTicket'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Container <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'typedi'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token comment\">/*\n  * KlassTicket의 종류 : FreeKlassTicket, PaidKlassTicket, expiredKlassTicket, InValidKlassTicket\n  */</span>\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Get KlassTickets'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> klassService <span class=\"token operator\">=</span> Container<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>KlassTicketService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> userId <span class=\"token operator\">=</span> userDefaultVariables<span class=\"token punctuation\">.</span>normalUser<span class=\"token punctuation\">.</span>firestoreId<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> KlassTicketMocks<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    freeKlassTicket<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n    paidKlassTicket<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n    expiredKlassTicket<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n    inValidKlassTicket<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> freeKlassTicket <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      userId<span class=\"token punctuation\">,</span>\n      _id<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ObjectId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> paidKlassTicket <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      userId<span class=\"token punctuation\">,</span>\n      _id<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ObjectId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">...</span>\n    KlassTicketMocks <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      freeKlassTicket<span class=\"token punctuation\">,</span>\n      paidKlassTicket<span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> KlassTicketModel<span class=\"token punctuation\">.</span><span class=\"token function\">insertMany</span><span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>KlassTicketMocks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> KlassTicketModel<span class=\"token punctuation\">.</span><span class=\"token function\">deleteMany</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Get Paid KlassTickets'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Check Get Only PaidKlassTickets'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> klassTickets <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> klassService<span class=\"token punctuation\">.</span><span class=\"token function\">getKlassTickets</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">{</span> userId <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>klassTickets<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveLength</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>klassTickets<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_id'</span><span class=\"token punctuation\">,</span> KlassTicketMocks<span class=\"token punctuation\">.</span>paidKlassTicket<span class=\"token punctuation\">.</span>_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Integration Test</h3>\n<p>통합 테스트는 실제로 GraphQL 콜을 통해 비즈니스 로직이 잘 동작하는지에 중점을 뒀습니다. 먼저 graphQL 콜을 하는 모듈을 따로 생성했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> authChecker <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@helpers/authChecker'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> GraphQLSchema <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'graphql'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ExecutionResultDataDefault <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'graphql/execution/execute'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> print <span class=\"token keyword\">as</span> gqlToString <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'graphql/language'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Maybe <span class=\"token keyword\">from</span> <span class=\"token string\">'graphql/tsutils/Maybe'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> buildSchema <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'type-graphql'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Container <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'typedi'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Options</span> <span class=\"token punctuation\">{</span>\n  source<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  variables<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Maybe<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  userId<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> schema<span class=\"token operator\">:</span> GraphQLSchema<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> graphqlCall <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token operator\">&lt;</span>ReturnType <span class=\"token operator\">=</span> ExecutionResultDataDefault<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> source<span class=\"token punctuation\">,</span> variables<span class=\"token punctuation\">,</span> userId <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> Options</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>schema<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    schema <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">buildSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      resolvers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      dateScalarMode<span class=\"token operator\">:</span> <span class=\"token string\">'isoDate'</span><span class=\"token punctuation\">,</span>\n      container<span class=\"token operator\">:</span> Container<span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> graphql<span class=\"token operator\">&lt;</span>ReturnType<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token comment\">//source의 경우 string 혹은 graphql-tag 타입으로 넣을 수 있습니다.</span>\n    schema<span class=\"token punctuation\">,</span>\n    source<span class=\"token operator\">:</span> <span class=\"token keyword\">typeof</span> source <span class=\"token operator\">!==</span> <span class=\"token string\">'string'</span> <span class=\"token operator\">?</span> <span class=\"token function\">gqlToString</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> source<span class=\"token punctuation\">,</span>\n    variableValues<span class=\"token operator\">:</span> variables<span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>우리는 GraphQL서버의 Schema&#x26;Type을 클라이언트 환경에서 사용할 수 있도록 Typescript 형태로 Generating하고 있습니다(CodeGen). 이에 서버의 변경 사항을 클라이언트에서 정적으로 알아차리고 처리할 수 있습니다. Monorepo를 사용하고 있기에 graphqls 라는 Repo에서 이를 관리합니다. 아래는 클래스101 카테고리를 불러오는 간단한 통합 테스트 예시입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'reflect-metadata'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CATEGORY_SUMMARY_LIST</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@class101/graphqls/category/queries/CategorySummaryList'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Category <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@graphqlSchema/category/category.type'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CategoryModel <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@mongooseModels/Category/Category'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> graphqlCall <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@utils/testUtils/graphqlCall'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'This is a main call Test Example'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> CategoryModel<span class=\"token punctuation\">.</span><span class=\"token function\">deleteMany</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> CategoryModel<span class=\"token punctuation\">.</span><span class=\"token function\">insertMany</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        _id<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ObjectId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        firestoreId<span class=\"token operator\">:</span> faker<span class=\"token punctuation\">.</span>internet<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">,</span>\n        title<span class=\"token operator\">:</span> <span class=\"token string\">'미술'</span><span class=\"token punctuation\">,</span>\n        iconUrl<span class=\"token operator\">:</span> faker<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">.</span>imageUrl<span class=\"token punctuation\">,</span>\n        klassCount<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        productCount<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        isHide<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Check CategorySummaryList available'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> graphqlCall<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span> categories<span class=\"token operator\">:</span> Category <span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        source<span class=\"token operator\">:</span> <span class=\"token constant\">CATEGORY_SUMMARY_LIST</span><span class=\"token punctuation\">,</span>\n        variables<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          categoryFilter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            isHide<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token operator\">...</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>data <span class=\"token operator\">&amp;&amp;</span> result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>categories<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>not<span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>마무리</h2>\n<p>클래스101은 테스트 커버리지를 높이기 위해 노력하고 있습니다. “테스트가 없는 코드는 레거시다”라는 말이 있듯이 짜임새 있게 테스트가 구축되어 있다면 유지보수도 훨씬 쉬워질 것입니다. </p>\n<h2>참고문헌</h2>\n<p><strong>웹사이트</strong><br>\n<a href=\"https://typegraphql.ml/\" target=\"_blank\" rel=\"nofollow\">https://typegraphql.ml</a><br>\n<a href=\"https://www.npmjs.com/package/mongodb-memory-server\" target=\"_blank\" rel=\"nofollow\">https://www.npmjs.com/package/mongodb-memory-server</a><br>\n<a href=\"https://www.npmjs.com/package/faker\" target=\"_blank\" rel=\"nofollow\">https://www.npmjs.com/package/faker</a><br>\n<a href=\"https://jestjs.io/docs/en/configuration\" target=\"_blank\" rel=\"nofollow\">https://jestjs.io/docs/en/configuration</a>  </p>","fields":{"slug":"blog/2019/09/09/grep","language":"ko"},"frontmatter":{"title":"Node.js Typescript & GraphQL환경에서 테스트 작성하기","thumbnail":"/images/default.jpg","date":"2019-09-09","description":"","author":{"id":"grep","profileImage":"/images/profiles/grep.png","description":"안녕하세요. 사람과 비즈니스가 좋은 개발자 이호연입니다.","github":"https://github.com/yansfil","blog":"https://tansfil.tistory.com/","linkedin":"ttps://www.linkedin.com/in/hoyeon-lee-a58702117/"},"tags":["typescript","tdd","nodejs","graphql"]}}},"pageContext":{"slug":"blog/2019/09/09/grep","language":"ko","previous":{"fields":{"slug":"blog/2019/07/24/donut","authorId":"donut","language":"ko"},"frontmatter":{"title":"Google Cloud Platform's Firestore의 특징과 한계","thumbnail":"/images/thumbnails/firestore.jpg","author":{"id":"donut","profileImage":"/images/profiles/donut.jpg","description":"all-round 개발자 도넛입니다.","github":"https://github.com/ochanje210","blog":"https://medium.com/@youngchanje","linkedin":"https://www.linkedin.com/in/youngchanje/"},"tags":["gcp","firestore","firebase"],"description":"","date":"2019-07-24T04:35:23.448Z"}},"next":null}}}